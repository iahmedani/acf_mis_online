<% layout('boilerplate') %>
  <style>
    .row {
      margin-bottom: 0 !important
    }
    .btn {
      width: 100%;
    }
  </style>
  <link type="text/css" rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/jsgrid/1.5.3/jsgrid.min.css" />
  <link type="text/css" rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/jsgrid/1.5.3/jsgrid-theme.min.css" />
  <link rel="stylesheet" href="https://ajax.googleapis.com/ajax/libs/jqueryui/1.12.1/themes/smoothness/jquery-ui.css">
  <div class="container">
    <div class="row">
      <form action="/myadmin/addProject" method="post" class="col s4">
        <div class="row">
        <ul class="collection">
          <li class="collection-item light-blue darken-4 white-text">Add Project</li>
        </ul>
          <div class="input-field col s6">
            <input type="text" name="project_name" id="project_name" required class="validate">
            <label for="project_name">Project Name:</label>
          </div>
          <div class="input-field col s6">
            <input type="text" name="project_code" id="project_code" required class="validate">
            <label for="project_code">Project Code:</label>
          </div>
        </div>
        <div class="row">
          <div class="input-field col s12">
            <textarea id="project_desc" name="project_desc" class="materialize-textarea validate" minlength="0" maxlength="255"></textarea>
            <label for="project_desc">Project Description</label>
          </div>
        </div>
        <div class="row">
          <div class="input-field col s6">
            <input type="text" name="start_date" id="start_date" required class="datepicker validate">
            <label for="start_date">Start Date:</label>
          </div>
          <div class="input-field col s6">
            <input type="text" name="end_date" id="end_date" required class="datepicker validate">
            <label for="end_date">End Date:</label>
          </div>
        </div>
        <div class="row">
          <div class="input-field col s12 ">
            <button class="btn waves-effect waves-light btn-block light-blue darken-4 white-text" type="submit">Submit
              <i class="material-icons right">send</i>
            </button>
          </div>

        </div>
      </form>
      <div class="col s8">
          <ul class="collection">
              <li class="collection-item light-blue darken-4 white-text">Project List</li>
            </ul>
        <div id="jsGrid"></div>
      </div>
    </div>
  </div>
  <script src="https://ajax.googleapis.com/ajax/libs/jqueryui/1.12.1/jquery-ui.min.js"></script>
  <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/jsgrid/1.5.3/jsgrid.min.js"></script>


  <script>
    var MyDateField = function (config) {
      jsGrid.Field.call(this, config);
    };

    MyDateField.prototype = new jsGrid.Field({

      css: "date-field", // redefine general property 'css'
      align: "center", // redefine general property 'align'

      myCustomProperty: "foo", // custom property

      sorter: function (date1, date2) {
        return new Date(date1) - new Date(date2);
      },

      itemTemplate: function (value) {
        return new Date(value).toDateString();
      },

      insertTemplate: function (value) {
        return this._insertPicker = $("<input>").datepicker({
          defaultDate: new Date()
        });
      },

      editTemplate: function (value) {
        return this._editPicker = $("<input>").datepicker().datepicker("setDate", new Date(value));
      },

      insertValue: function () {
        return this._insertPicker.datepicker("getDate").toISOString();
      },

      editValue: function () {
        return this._editPicker.datepicker("getDate").toISOString();
      }
    });

    jsGrid.fields.date = MyDateField;
    var x = <%- result -%>;
    console.log(x)
    document.addEventListener('DOMContentLoaded', function () {
      var elems = document.querySelectorAll('.datepicker');
      var instances = M.Datepicker.init(elems, {
        autoClose: true
      });
    });
    $("#jsGrid").jsGrid({
      width: "100%",
      height: "350px",

      // inserting: true,
      // editing: true,
      sorting: true,
      paging: true,

      data: x,

      fields: [{
          name: "project_id",
          title: 'Id',
          type: "number",
          width: 30
        },
        {
          name: "project_name",
          title: 'Project',
          type: "text"
        },
        {
          name: "project_code",
          title: 'Code',
          type: "text"
        },
        {
          name: "start_date",
          title: 'Start Date',
          type: "date",
          width: 150
        },
        {
          name: "end_date",
          title: 'End Date',
          type: "date",
          width: 150
        }
      ]
    });
  </script>